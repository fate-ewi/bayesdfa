<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a Bayesian DFA — fit_dfa • bayesdfa</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Fit a Bayesian DFA — fit_dfa" />
<meta property="og:description" content="Fit a Bayesian DFA" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesdfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bayesdfa.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/combining_data.html">Combining data with bayesdfa</a>
    </li>
    <li>
      <a href="../articles/compositional.html">Fitting compositional dynamic factor models with bayesdfa</a>
    </li>
    <li>
      <a href="../articles/covariates.html">Examples of including covariates with bayesdfa</a>
    </li>
    <li>
      <a href="../articles/estimate_process_sigma.html">Estimating process trend variability with bayesdfa</a>
    </li>
    <li>
      <a href="../articles/optimization.html">Examples of fitting DFA models to big data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fate-ewi/bayesdfa/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Bayesian DFA</h1>
    <small class="dont-index">Source: <a href='https://github.com/fate-ewi/bayesdfa/blob/master/R/fit_dfa.R'><code>R/fit_dfa.R</code></a></small>
    <div class="hidden name"><code>fit_dfa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit a Bayesian DFA</p>
    </div>

    <pre class="usage"><span class='fu'>fit_dfa</span><span class='op'>(</span>
  y <span class='op'>=</span> <span class='va'>y</span>,
  num_trends <span class='op'>=</span> <span class='fl'>1</span>,
  varIndx <span class='op'>=</span> <span class='cn'>NULL</span>,
  scale <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"zscore"</span>, <span class='st'>"center"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
  iter <span class='op'>=</span> <span class='fl'>2000</span>,
  chains <span class='op'>=</span> <span class='fl'>4</span>,
  thin <span class='op'>=</span> <span class='fl'>1</span>,
  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.99</span>, max_treedepth <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>,
  nu_fixed <span class='op'>=</span> <span class='fl'>101</span>,
  est_correlation <span class='op'>=</span> <span class='cn'>FALSE</span>,
  estimate_nu <span class='op'>=</span> <span class='cn'>FALSE</span>,
  estimate_trend_ar <span class='op'>=</span> <span class='cn'>FALSE</span>,
  estimate_trend_ma <span class='op'>=</span> <span class='cn'>FALSE</span>,
  estimate_process_sigma <span class='op'>=</span> <span class='cn'>FALSE</span>,
  equal_process_sigma <span class='op'>=</span> <span class='cn'>TRUE</span>,
  estimation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sampling"</span>, <span class='st'>"optimizing"</span>, <span class='st'>"vb"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
  data_shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wide"</span>, <span class='st'>"long"</span><span class='op'>)</span>,
  obs_covar <span class='op'>=</span> <span class='cn'>NULL</span>,
  pro_covar <span class='op'>=</span> <span class='cn'>NULL</span>,
  z_bound <span class='op'>=</span> <span class='cn'>NULL</span>,
  z_model <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"dfa"</span>, <span class='st'>"proportion"</span><span class='op'>)</span>,
  trend_model <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rw"</span>, <span class='st'>"spline"</span>, <span class='st'>"gp"</span><span class='op'>)</span>,
  n_knots <span class='op'>=</span> <span class='cn'>NULL</span>,
  knot_locs <span class='op'>=</span> <span class='cn'>NULL</span>,
  par_list <span class='op'>=</span> <span class='cn'>NULL</span>,
  family <span class='op'>=</span> <span class='st'>"gaussian"</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  gp_theta_prior <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span>,
  expansion_prior <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>A matrix of data to fit. See <code>data_shape</code> option to specify whether
this is long or wide format data. Wide format data (default) is a matrix with
time across columns and unique time series across rows, and can only contain 1 observation
per time series - time combination. In contrast, long format data is a data frame that includes
observations ("obs"), time ("time") and time series ("ts") identifiers -- the benefit of long
format is that multiple observations per time series can be included. Correlation matrix currently
not estimated if data shape is long.</p></td>
    </tr>
    <tr>
      <th>num_trends</th>
      <td><p>Number of trends to fit.</p></td>
    </tr>
    <tr>
      <th>varIndx</th>
      <td><p>Indices indicating which timeseries should have shared
variances.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>Character string, used to standardized data. Can be "zscore" to center and
standardize data, "center" to just standardize data, or "none". Defaults to "zscore"</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Number of iterations in Stan sampling, defaults to 2000.</p></td>
    </tr>
    <tr>
      <th>chains</th>
      <td><p>Number of chains in Stan sampling, defaults to 4.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>Thinning rate in Stan sampling, defaults to 1.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of options to pass to Stan sampling. Defaults to
<code><a href='https://rdrr.io/r/base/list.html'>list(adapt_delta = 0.99, max_treedepth = 20)</a></code>.</p></td>
    </tr>
    <tr>
      <th>nu_fixed</th>
      <td><p>Student t degrees of freedom parameter. If specified as
greater than 100, a normal random walk is used instead of a random walk
with a t-distribution. Defaults to <code>101</code>.</p></td>
    </tr>
    <tr>
      <th>est_correlation</th>
      <td><p>Boolean, whether to estimate correlation of
observation error matrix <code>R</code>. Defaults to <code>FALSE</code>. Currently can't be estimated if data are in long format.</p></td>
    </tr>
    <tr>
      <th>estimate_nu</th>
      <td><p>Logical. Estimate the student t degrees of freedom
parameter? Defaults to <code>FALSE</code>,</p></td>
    </tr>
    <tr>
      <th>estimate_trend_ar</th>
      <td><p>Logical. Estimate AR(1) parameters on DFA trends?
Defaults to `FALSE``, in which case AR(1) parameters are set to 1</p></td>
    </tr>
    <tr>
      <th>estimate_trend_ma</th>
      <td><p>Logical. Estimate MA(1) parameters on DFA trends?
Defaults to `FALSE``, in which case MA(1) parameters are set to 0.</p></td>
    </tr>
    <tr>
      <th>estimate_process_sigma</th>
      <td><p>Logical. Defaults FALSE, whether or not to estimate process error sigma. If not estimated,
sigma is fixed at 1, like conventional DFAs.</p></td>
    </tr>
    <tr>
      <th>equal_process_sigma</th>
      <td><p>Logical. If process sigma is estimated, whether or not to estimate a single shared value across trends (default)
or estimate equal values for each trend</p></td>
    </tr>
    <tr>
      <th>estimation</th>
      <td><p>Character string. Should the model be sampled using <code><a href='https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html'>rstan::sampling()</a></code> ("sampling",default),
<a href='"optimizing"'>rstan::optimizing()</a>, variational inference <a href='"vb"'>rstan::vb()</a>,
or no estimation done ("none"). No estimation may be useful for debugging and simulation.</p></td>
    </tr>
    <tr>
      <th>data_shape</th>
      <td><p>If <code>wide</code> (the current default) then the input data should
have rows representing the various timeseries and columns representing the
values through time. This matches the MARSS input data format. If <code>long</code>
then the long format data is a data frame that includes observations ("obs"),
time ("time") and time series ("ts") identifiers -- the benefit of long
format is that multiple observations per time series can be included</p></td>
    </tr>
    <tr>
      <th>obs_covar</th>
      <td><p>Optional dataframe of data with 4 named columns ("time","timeseries","covariate","value"), representing: (1) time, (2) the time series
affected, (3) the covariate number for models with more than one covariate affecting each
trend, and (4) the value of the covariate</p></td>
    </tr>
    <tr>
      <th>pro_covar</th>
      <td><p>Optional dataframe of data with 4 named columns ("time","trend","covariate","value"), representing: (1) time, (2) the trend
affected, (3) the covariate number for models with more than one covariate affecting each
trend, and (4) the value of the covariate</p></td>
    </tr>
    <tr>
      <th>z_bound</th>
      <td><p>Optional hard constraints for estimated factor loadings -- really only applies to model with 1 trend. Passed in as a 2-element vector representing the lower and upper bound, e.g. (0, 100) to constrain positive</p></td>
    </tr>
    <tr>
      <th>z_model</th>
      <td><p>Optional argument allowing for elements of Z to be constrained to be proportions (each time series modeled as a mixture of trends). Arguments can be "dfa" (default) or "proportion"</p></td>
    </tr>
    <tr>
      <th>trend_model</th>
      <td><p>Optional argument to change the model of the underlying latent trend. By default this is set to 'rw', where the trend
is modeled as a random walk - as in conentional DFA. Alternative options are 'spline', where B-splines are used to model the trends
or 'gp', where gaussian predictive processes are used. If models other than 'rw' are used, there are some key points. First, the MA and AR
parameters on these models will be turned off. Second, for B-splines the process_sigma becomes an optional scalar on the spline coefficients,
and is turned off by default. Third, the number of knots can be specified (more knots = more wiggliness, and n_knots &lt; N). For models
with &gt; 2 trends, each trend has their own spline coefficients estimated though the knot locations are assumed shared. If knots aren't specified,
the default is N/3.</p></td>
    </tr>
    <tr>
      <th>n_knots</th>
      <td><p>The number of knots for the B-spline of Gaussian predictive process models. Optional, defaults to round(N/3)</p></td>
    </tr>
    <tr>
      <th>knot_locs</th>
      <td><p>Locations of knots (optional), defaults to uniform spacing between 1 and N</p></td>
    </tr>
    <tr>
      <th>par_list</th>
      <td><p>A vector of parameter names of variables to be estimated by Stan. If NULL, this will default to
c("x", "Z", "sigma", "log_lik", "psi","xstar") for most models -- though if AR / MA, or Student-t models are used
additional parameters will be monitored. If you want to use diagnostic tools in rstan, including moment_matching,
you will need to pass in a larger list. Setting this argument to "all" will monitor all parameters, enabling the use
of diagnostic functions -- but making the models a lot larger for storage. Finally, this argument may be a custom string
of parameters to monitor, e.g. c("x","sigma")</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>String describing the observation model. Default is "gaussian",
but included options are "gamma", "lognormal", negative binomial ("nbinom2"),
"poisson", or "binomial". The binomial family is assumed to have logit link,
gaussian family is assumed to be identity, and the rest are log-link.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to print iterations and information from Stan, defaults to FALSE.</p></td>
    </tr>
    <tr>
      <th>gp_theta_prior</th>
      <td><p>A 2-element vector controlling the prior on the Gaussian process parameter in cov_exp_quad.
This prior is a half-Student t prior, with the first argument of gp_theta_prior being the degrees of freedom (nu),
and the second element being the standard deviation</p></td>
    </tr>
    <tr>
      <th>expansion_prior</th>
      <td><p>Defaults to FALSE, if TRUE uses the parameter expansion prior of Ghosh &amp; Dunson 2009</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any other arguments to pass to <code><a href='https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html'>rstan::sampling()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that there is nothing restricting the loadings and trends from
being inverted (i.e. multiplied by <code>-1</code>) for a given chain. Therefore, if
you fit multiple chains, the package will attempt to determine which chains
need to be inverted using the function <code><a href='find_inverted_chains.html'>find_inverted_chains()</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>plot_loadings plot_trends rotate_trends find_swans</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>42</span><span class='op'>)</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_dfa.html'>sim_dfa</a></span><span class='op'>(</span>num_trends <span class='op'>=</span> <span class='fl'>1</span>, num_years <span class='op'>=</span> <span class='fl'>20</span>, num_ts <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='co'># only 1 chain and 250 iterations used so example runs quickly:</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'dfa' NOW (CHAIN 1).
#&gt; Chain 1: 
#&gt; Chain 1: Gradient evaluation took 3.4e-05 seconds
#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.34 seconds.
#&gt; Chain 1: Adjust your expectations accordingly!
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: WARNING: There aren't enough warmup iterations to fit the
#&gt; Chain 1:          three stages of adaptation as currently configured.
#&gt; Chain 1:          Reducing each adaptation stage to 15%/75%/10% of
#&gt; Chain 1:          the given number of warmup iterations:
#&gt; Chain 1:            init_buffer = 3
#&gt; Chain 1:            adapt_window = 20
#&gt; Chain 1:            term_buffer = 2
#&gt; Chain 1: 
#&gt; Chain 1: Iteration:  1 / 50 [  2%]  (Warmup)
#&gt; Chain 1: Iteration:  5 / 50 [ 10%]  (Warmup)
#&gt; Chain 1: Iteration: 10 / 50 [ 20%]  (Warmup)
#&gt; Chain 1: Iteration: 15 / 50 [ 30%]  (Warmup)
#&gt; Chain 1: Iteration: 20 / 50 [ 40%]  (Warmup)
#&gt; Chain 1: Iteration: 25 / 50 [ 50%]  (Warmup)
#&gt; Chain 1: Iteration: 26 / 50 [ 52%]  (Sampling)
#&gt; Chain 1: Iteration: 30 / 50 [ 60%]  (Sampling)
#&gt; Chain 1: Iteration: 35 / 50 [ 70%]  (Sampling)
#&gt; Chain 1: Iteration: 40 / 50 [ 80%]  (Sampling)
#&gt; Chain 1: Iteration: 45 / 50 [ 90%]  (Sampling)
#&gt; Chain 1: Iteration: 50 / 50 [100%]  (Sampling)
#&gt; Chain 1: 
#&gt; Chain 1:  Elapsed Time: 0.004663 seconds (Warm-up)
#&gt; Chain 1:                0.061156 seconds (Sampling)
#&gt; Chain 1:                0.065819 seconds (Total)
#&gt; Chain 1: </div><div class='output co'>#&gt; <span class='warning'>Warning: There were 16 divergent transitions after warmup. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
#&gt; <span class='warning'>to find out why this is a problem and how to eliminate them.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There were 1 chains where the estimated Bayesian Fraction of Missing Information was low. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#bfmi-low</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Examine the pairs() plot to diagnose sampling problems</span></div><div class='output co'>#&gt; <span class='warning'>Warning: The largest R-hat is 2.11, indicating chains have not mixed.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#r-hat</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#bulk-ess</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#tail-ess</span></div><div class='output co'>#&gt; Inference for the input samples (1 chains: each with iter = 25; warmup = 12):
#&gt; 
#&gt;                Q5   Q50   Q95  Mean  SD  Rhat Bulk_ESS Tail_ESS
#&gt; x[1,1]        0.3   0.3   0.7   0.4 0.2  2.19       13       13
#&gt; x[1,2]       -0.2   0.0   0.0   0.0 0.1  1.72        4       13
#&gt; x[1,3]        0.2   0.2   0.9   0.5 0.3  2.19        4       13
#&gt; x[1,4]        0.5   0.6   1.0   0.7 0.2  2.19        6       13
#&gt; x[1,5]       -0.2   0.5   1.0   0.4 0.4  2.19       13       13
#&gt; x[1,6]        0.4   1.3   1.4   1.1 0.4  2.19        8       13
#&gt; x[1,7]        0.3   1.0   1.0   0.8 0.3  2.10        6       13
#&gt; x[1,8]        0.5   0.7   1.1   0.7 0.3  2.19       13       13
#&gt; x[1,9]        0.4   0.5   1.4   0.7 0.6  1.62       12       13
#&gt; x[1,10]       1.5   1.6   2.5   1.8 0.5  2.19       12       13
#&gt; x[1,11]       2.0   2.7   2.9   2.6 0.4  2.08        6       13
#&gt; x[1,12]       0.8   2.2   2.3   1.8 0.6  2.10        4       13
#&gt; x[1,13]       0.0   1.2   1.3   0.8 0.6  2.10        7       13
#&gt; x[1,14]      -0.9  -0.2   0.1  -0.3 0.4  2.08        6       13
#&gt; x[1,15]      -1.0  -1.0  -0.3  -0.7 0.3  2.08        4       13
#&gt; x[1,16]      -2.2  -2.0  -1.3  -1.8 0.4  2.10        4       13
#&gt; x[1,17]      -2.6  -2.4  -2.0  -2.3 0.2  2.08        9       13
#&gt; x[1,18]      -2.4  -2.0  -1.3  -1.9 0.5  1.18        8       13
#&gt; x[1,19]      -1.9  -1.7  -0.7  -1.4 0.5  2.08        7       13
#&gt; x[1,20]      -1.4  -1.2   0.0  -0.8 0.5  2.10        8       13
#&gt; Z[1,1]       -0.9  -0.7  -0.6  -0.7 0.1  1.20       13       13
#&gt; Z[2,1]       -0.7  -0.4  -0.2  -0.4 0.2  1.46       13       13
#&gt; Z[3,1]       -0.8  -0.5  -0.4  -0.6 0.1  1.72        4       13
#&gt; log_lik[1]   -0.7  -0.4  -0.4  -0.5 0.1  2.19       13       13
#&gt; log_lik[2]   -2.4  -2.1  -1.8  -2.1 0.2  1.95       13       13
#&gt; log_lik[3]   -1.0  -0.6  -0.6  -0.7 0.2  1.18        8       13
#&gt; log_lik[4]   -0.8  -0.5  -0.4  -0.5 0.1  2.08       12       13
#&gt; log_lik[5]   -0.8  -0.5  -0.5  -0.6 0.1  2.08       13       13
#&gt; log_lik[6]   -0.7  -0.5  -0.4  -0.5 0.1  2.08       12       13
#&gt; log_lik[7]   -0.7  -0.6  -0.4  -0.6 0.1  2.19       13       13
#&gt; log_lik[8]   -2.2  -1.3  -1.2  -1.5 0.4  1.95        6       13
#&gt; log_lik[9]   -2.4  -1.1  -1.0  -1.4 0.5  2.10        4       13
#&gt; log_lik[10]  -0.7  -0.4  -0.4  -0.5 0.1  2.19        4       13
#&gt; log_lik[11]  -0.7  -0.4  -0.4  -0.5 0.1  2.10        9       13
#&gt; log_lik[12]  -0.8  -0.7  -0.3  -0.6 0.2  1.62       13       13
#&gt; log_lik[13]  -1.3  -0.7  -0.7  -0.8 0.3  1.33        5       13
#&gt; log_lik[14]  -0.9  -0.6  -0.4  -0.6 0.2  2.08       12       13
#&gt; log_lik[15]  -2.5  -1.1  -0.8  -1.3 0.6  2.19       13       13
#&gt; log_lik[16]  -0.9  -0.5  -0.4  -0.5 0.2  1.18        9       13
#&gt; log_lik[17]  -0.7  -0.5  -0.4  -0.5 0.1  1.77        8       13
#&gt; log_lik[18]  -0.8  -0.6  -0.4  -0.6 0.1  1.88        4       13
#&gt; log_lik[19]  -0.9  -0.8  -0.4  -0.7 0.2  1.63        7       13
#&gt; log_lik[20]  -0.7  -0.6  -0.5  -0.6 0.1  2.08       13       13
#&gt; log_lik[21]  -0.8  -0.5  -0.4  -0.6 0.1  1.88       11       13
#&gt; log_lik[22]  -2.5  -2.0  -1.6  -2.0 0.3  1.51        8       13
#&gt; log_lik[23]  -0.8  -0.6  -0.5  -0.6 0.1  2.08       13       13
#&gt; log_lik[24]  -0.8  -0.5  -0.4  -0.5 0.2  1.77       10       13
#&gt; log_lik[25]  -1.6  -0.6  -0.6  -0.8 0.6  1.33        5       13
#&gt; log_lik[26]  -0.8  -0.5  -0.5  -0.6 0.1  1.95       13       13
#&gt; log_lik[27]  -1.1  -1.0  -0.7  -1.0 0.1  1.30        5       13
#&gt; log_lik[28]  -1.0  -0.5  -0.4  -0.6 0.3  2.19        7       13
#&gt; log_lik[29]  -0.9  -0.7  -0.4  -0.7 0.2  1.03       13       13
#&gt; log_lik[30]  -1.4  -1.0  -0.4  -0.9 0.4  1.72        4       13
#&gt; log_lik[31]  -0.8  -0.5  -0.4  -0.6 0.2  1.00        9       13
#&gt; log_lik[32]  -3.7  -2.3  -1.1  -2.3 0.9  1.03       13       13
#&gt; log_lik[33]  -1.2  -0.7  -0.4  -0.8 0.3  1.05        8       13
#&gt; log_lik[34]  -2.0  -0.9  -0.5  -1.0 0.6  2.08        4       13
#&gt; log_lik[35]  -3.9  -2.2  -1.8  -2.4 0.7  1.50        5       13
#&gt; log_lik[36]  -1.1  -0.5  -0.4  -0.6 0.3  1.18        7       13
#&gt; log_lik[37]  -1.0  -0.6  -0.5  -0.7 0.2  1.51        5       13
#&gt; log_lik[38]  -2.1  -1.1  -1.0  -1.3 0.4  2.19        4       13
#&gt; log_lik[39]  -1.0  -0.5  -0.4  -0.6 0.2  2.19        4       13
#&gt; log_lik[40]  -1.7  -0.6  -0.6  -0.9 0.4  2.19        4       13
#&gt; log_lik[41]  -0.8  -0.5  -0.3  -0.5 0.1  1.46       13       13
#&gt; log_lik[42]  -0.9  -0.5  -0.3  -0.6 0.2  2.08       13       13
#&gt; log_lik[43]  -2.5  -1.2  -1.0  -1.5 0.6  1.77       13       13
#&gt; log_lik[44]  -0.7  -0.5  -0.3  -0.5 0.1  1.18       12       13
#&gt; log_lik[45]  -1.1  -0.8  -0.5  -0.8 0.2  1.58        7       13
#&gt; log_lik[46]  -1.3  -0.5  -0.4  -0.8 0.3  2.08        4       13
#&gt; log_lik[47]  -1.5  -1.2  -0.7  -1.1 0.3  1.46       10       13
#&gt; log_lik[48]  -1.0  -0.7  -0.5  -0.8 0.2  1.12        8       13
#&gt; log_lik[49]  -1.1  -0.5  -0.4  -0.6 0.3  1.77        7       13
#&gt; log_lik[50]  -5.1  -4.3  -1.7  -4.0 1.2  1.19       13       13
#&gt; log_lik[51]  -1.3  -0.9  -0.4  -0.9 0.3  1.09        8       13
#&gt; log_lik[52]  -1.5  -0.7  -0.4  -0.8 0.4  1.41       13       13
#&gt; log_lik[53]  -2.4  -1.7  -1.3  -1.8 0.4  1.18       11       13
#&gt; log_lik[54]  -1.1  -0.8  -0.5  -0.8 0.2  0.99       13       13
#&gt; log_lik[55]  -0.9  -0.6  -0.5  -0.6 0.1  1.33       13       13
#&gt; log_lik[56]  -4.2  -3.4  -2.3  -3.3 0.7  2.19        4        5
#&gt; log_lik[57]  -0.8  -0.5  -0.4  -0.5 0.1  1.62       13       13
#&gt; log_lik[58]  -0.8  -0.7  -0.5  -0.7 0.1  0.97       13       13
#&gt; log_lik[59]  -0.7  -0.6  -0.4  -0.6 0.1  2.08       13       13
#&gt; log_lik[60]  -0.8  -0.5  -0.5  -0.6 0.1  1.30        6       13
#&gt; xstar[1,1]   -2.7  -0.7   1.1  -0.7 1.2  1.09       13       13
#&gt; sigma[1]      0.6   0.6   0.8   0.7 0.1  2.08       13       13
#&gt; lp__        -59.5 -49.2 -46.5 -51.7 5.4  2.10        4       13
#&gt; 
#&gt; For each parameter, Bulk_ESS and Tail_ESS are crude measures of 
#&gt; effective sample size for bulk and tail quantities respectively (an ESS &gt; 100 
#&gt; per chain is considered good), and Rhat is the potential scale reduction 
#&gt; factor on rank normalized split chains (at convergence, Rhat &lt;= 1.05).</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># example of observation error covariates</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>42</span><span class='op'>)</span>
<span class='va'>obs_covar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='st'>"time"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>, <span class='st'>"timeseries"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='st'>"covariate"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>obs_covar</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>obs_covar</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span>, obs_covar <span class='op'>=</span> <span class='va'>obs_covar</span><span class='op'>)</span>

<span class='co'># example of process error covariates</span>
<span class='va'>pro_covar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='st'>"time"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>, <span class='st'>"trend"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='st'>"covariate"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>pro_covar</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>pro_covar</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span>, num_trends <span class='op'>=</span> <span class='fl'>2</span>, pro_covar <span class='op'>=</span> <span class='va'>pro_covar</span><span class='op'>)</span>

<span class='co'># example of long format data</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_dfa.html'>sim_dfa</a></span><span class='op'>(</span>num_trends <span class='op'>=</span> <span class='fl'>1</span>, num_years <span class='op'>=</span> <span class='fl'>20</span>, num_ts <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>obs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='va'>long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"obs"</span> <span class='op'>=</span> <span class='va'>obs</span>, <span class='st'>"ts"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"time"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>long</span>, data_shape <span class='op'>=</span> <span class='st'>"long"</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># example of long format data with obs covariates</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_dfa.html'>sim_dfa</a></span><span class='op'>(</span>num_trends <span class='op'>=</span> <span class='fl'>1</span>, num_years <span class='op'>=</span> <span class='fl'>20</span>, num_ts <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>obs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='va'>long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"obs"</span> <span class='op'>=</span> <span class='va'>obs</span>, <span class='st'>"ts"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"time"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>obs_covar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='st'>"time"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>, <span class='st'>"timeseries"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='st'>"covariate"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>obs_covar</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>obs_covar</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>long</span>, data_shape <span class='op'>=</span> <span class='st'>"long"</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span>, obs_covar <span class='op'>=</span> <span class='va'>obs_covar</span><span class='op'>)</span>

<span class='co'># example of model with Z constrained to be proportions and wide format data</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_dfa.html'>sim_dfa</a></span><span class='op'>(</span>num_trends <span class='op'>=</span> <span class='fl'>1</span>, num_years <span class='op'>=</span> <span class='fl'>20</span>, num_ts <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span>, z_model <span class='op'>=</span> <span class='st'>"proportion"</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># example of model with Z constrained to be proportions and long format data</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_dfa.html'>sim_dfa</a></span><span class='op'>(</span>num_trends <span class='op'>=</span> <span class='fl'>1</span>, num_years <span class='op'>=</span> <span class='fl'>20</span>, num_ts <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>obs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='va'>long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"obs"</span> <span class='op'>=</span> <span class='va'>obs</span>, <span class='st'>"ts"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"time"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>long</span>, data_shape <span class='op'>=</span> <span class='st'>"long"</span>, z_model <span class='op'>=</span> <span class='st'>"proportion"</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#' # example of B-spline model with wide format data</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_dfa.html'>sim_dfa</a></span><span class='op'>(</span>num_trends <span class='op'>=</span> <span class='fl'>1</span>, num_years <span class='op'>=</span> <span class='fl'>20</span>, num_ts <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span>, trend_model <span class='op'>=</span> <span class='st'>"spline"</span>, n_knots <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

<span class='co'># example of B-spline model with wide format data</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_dfa.html'>sim_dfa</a></span><span class='op'>(</span>num_trends <span class='op'>=</span> <span class='fl'>1</span>, num_years <span class='op'>=</span> <span class='fl'>20</span>, num_ts <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'>fit_dfa</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>y_sim</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, chains <span class='op'>=</span> <span class='fl'>1</span>, trend_model <span class='op'>=</span> <span class='st'>"gp"</span>, n_knots <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Eric J. Ward, Sean C. Anderson, Luis A. Damiano, Michael J. Malick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


